(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5228c942","chunk-0b430027"],{"2fcf":function(e,t,i){"use strict";i.r(t);i("7f7f"),i("7514");var o=i("75fc"),s={name:"page1",components:{goodsCard:i("742e").default},data:function(){return{typeList:[{label:"手机",value:1},{label:"电脑",value:2},{label:"美妆",value:3},{label:"服饰",value:4},{label:"食品",value:5},{label:"潮鞋",value:6},{label:"其他",value:0}],data:[],page:1,pageSize:8,keywords:"",count:0,type:"",dialogVisible:!1,form:{name:"",price:"",des:"",typename:"",typeid:"",mobile:"",email:"",img:""},formLabelWidth:"100px",fileList:[],rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:1,max:20,message:"长度在1到20个字符",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{min:1,max:20,message:"长度在1到20个字符",trigger:"blur"}],typeid:[{required:!0,message:"请选择商品类型",trigger:"change"}],des:[{required:!0,message:"请输入商品描述",trigger:"blur"},{min:1,max:20,message:"长度在1到20个字符",trigger:"blur"}],mobile:[{required:!0,message:"请输入商户手机号",trigger:"blur"},{min:1,max:20,message:"长度在1到20个字符",trigger:"blur"}],email:[{required:!0,message:"请输入商户邮箱",trigger:"blur"},{min:1,max:20,message:"长度在1到20个字符",trigger:"blur"}],img:[{required:!0,message:"请上传该商品的图片",trigger:"blur"}]},pullDownTip:"",opt:""}},watch:{data:function(){var e=this;this.$nextTick(function(){e.$refs.scroll.refresh()})}},computed:{username:function(){return this.$store.state.d2admin.user.info.username},token:function(){return this.$store.state.d2admin.user.info.token}},mounted:function(){this.getList()},methods:{update:function(e){this.opt="update",this.dialogVisible=!0,this.form=e,this.fileList=[]},del:function(e,t){var i=this;this.$http.post("/pc/deletegoods",e).then(function(e){i.data.splice(t,1),i.count--,i.$message.success("删除商品成功")})},scroll:function(e){-70<e.y&&(this.pullDownTip="不要再拉我啦，生气了哦"),e.y<=-70&&(this.pullDownTip="释放本宝宝要刷新了哦")},getList:function(e){var t=this,i=0<arguments.length&&void 0!==e?e:"add";this.$http.get("/pc/readgoods",{params:{keywords:this.keywords,type:this.type,page:this.page,pageSize:this.pageSize}}).then(function(e){"add"===i&&(t.data=[].concat(Object(o.a)(t.data),Object(o.a)(e.data)),t.$refs.scroll.pullUpFinish(t.data.length===e.count)),"refresh"===i&&(t.data=e.data,t.$refs.scroll.pullDownFinish(t.data.length===e.count)),t.count=e.count,t.page++})},add:function(){this.opt="add",this.form={},this.fileList=[],this.dialogVisible=!0},refresh:function(){this.page=1,this.getList("refresh")},loadmore:function(){this.getList()},saveGoodsInfo:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;"add"===t.opt&&t.$http.post("/pc/addgoods",t.form).then(function(e){t.$message.success("发布商品成功"),t.dialogVisible=!1,t.refresh(),t.form={}}),"update"===t.opt&&t.$http.post("/pc/updategoods",t.form).then(function(e){t.$message.success("修改商品成功"),t.dialogVisible=!1})})},handleClose:function(){this.dialogVisible=!1},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.page=e,this.getList()},changeType:function(t,e){this.form.typename=this.typeList.find(function(e){return e.value===t}).label},handleRemove:function(e,t){this.form.img=""},handleSuccess:function(e,t,i){this.form.img=e.result.src},handleExceed:function(e,t){this.$message.warning("只能上传一个商品图片")},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))}}},a=(i("a9a1"),i("2877")),r=function(e){e.options.__source="src/views/demo/page1/index.vue"},l=Object(a.a)(s,function(){var i=this,e=i.$createElement,o=i._self._c||e;return o("div",[o("d2-container",{ref:"scroll",attrs:{type:"ghost","better-scroll":"","better-scroll-options":{pullUpLoad:{threshold:100},pullDownRefresh:{threshold:50,stop:50}}},on:{scroll:i.scroll,pullingDown:i.refresh,pullingUp:i.loadmore}},[o("template",{slot:"header"},[o("el-input",{staticClass:"d2-mr",staticStyle:{width:"150px"},attrs:{clearable:"","prefix-icon":"el-icon-search",size:"mini",placeholder:"请输入商品名称"},on:{change:function(e){return i.refresh("refresh")}},model:{value:i.keywords,callback:function(e){i.keywords="string"==typeof e?e.trim():e},expression:"keywords"}}),o("el-select",{staticClass:"d2-mr",attrs:{placeholder:"请选择商品类型",size:"mini",clearable:""},model:{value:i.type,callback:function(e){i.type=e},expression:"type"}},i._l(i.typeList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),i.username?o("el-button",{staticClass:"d2-ml",attrs:{size:"mini",type:"primary"},on:{click:i.add}},[i._v("发布商品")]):i._e(),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:i.refresh}},[i._v("搜索")]),o("div",{staticClass:"tip tip_ab"},[i._v("发布商品信息请联系站长")])],1),o("el-row",{attrs:{gutter:10}},[o("div",{staticClass:"pullDownTip"},[o("span",[i._v(i._s(i.pullDownTip))])]),i._l(i.data,function(e,t){return o("el-col",{key:t,staticClass:"d2-mb",attrs:{span:4}},[o("goodsCard",{attrs:{goodsinfo:e,index:t},on:{update:i.update,delete:i.del}})],1)})],2),o("el-row",[i.count===i.data.length?o("div",{staticClass:"tip",staticStyle:{color:"white","text-align":"center"}},[i._v("没有更多数据啦~~~")]):i._e()])],2),o("el-dialog",{attrs:{title:"提示",visible:i.dialogVisible,width:"50%","before-close":i.handleClose},on:{"update:visible":function(e){i.dialogVisible=e}}},[o("el-form",{ref:"form",attrs:{model:i.form,rules:i.rules,size:"mini"}},[o("el-form-item",{attrs:{prop:"name",label:"商品名称","label-width":i.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入商品名称"},model:{value:i.form.name,callback:function(e){i.$set(i.form,"name","string"==typeof e?e.trim():e)},expression:"form.name"}})],1),o("el-form-item",{attrs:{prop:"price",label:"商品价格","label-width":i.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入商品名称"},model:{value:i.form.price,callback:function(e){i.$set(i.form,"price","string"==typeof e?e.trim():e)},expression:"form.price"}})],1),o("el-form-item",{attrs:{prop:"typeid",label:"商品类型","label-width":i.formLabelWidth}},[o("el-select",{attrs:{placeholder:"请选择您的商品分类"},on:{change:i.changeType},model:{value:i.form.typeid,callback:function(e){i.$set(i.form,"typeid",e)},expression:"form.typeid"}},i._l(i.typeList,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),o("el-form-item",{attrs:{prop:"des",label:"商品描述","label-width":i.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入描述该商品的一些信息"},model:{value:i.form.des,callback:function(e){i.$set(i.form,"des","string"==typeof e?e.trim():e)},expression:"form.des"}})],1),o("el-form-item",{attrs:{prop:"mobile",label:"手机号","label-width":i.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入发布者的手机号"},model:{value:i.form.mobile,callback:function(e){i.$set(i.form,"mobile","string"==typeof e?e.trim():e)},expression:"form.mobile"}})],1),o("el-form-item",{attrs:{prop:"email",label:"邮箱","label-width":i.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"off",placeholder:"请输入发布者的邮箱"},model:{value:i.form.email,callback:function(e){i.$set(i.form,"email","string"==typeof e?e.trim():e)},expression:"form.email"}})],1),o("el-form-item",{attrs:{prop:"img",label:"商品图片地址","label-width":i.formLabelWidth}},[o("el-upload",{staticClass:"upload-demo",attrs:{action:i.$http.defaults.baseURL+"/pc/uploadimage",accept:".png,.jpg,.jpeg","on-remove":i.handleRemove,"before-remove":i.beforeRemove,name:"file",headers:{Authorization:"Bearer "+i.token},limit:1,"list-type":"picture","on-exceed":i.handleExceed,"on-success":i.handleSuccess,"file-list":i.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[i._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[i._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:function(e){i.dialogVisible=!1}}},[i._v("取 消")]),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:i.saveGoodsInfo}},[i._v("确 定")])],1)],1)],1)},[],!1,null,"0867a6c3",null);"function"==typeof r&&r(l);t.default=l.exports},"3bd3":function(e,t,i){},"6dc8":function(e,t,i){"use strict";var o=i("e941");i.n(o).a},"742e":function(e,t,i){"use strict";i.r(t);i("8e6e"),i("ac6a"),i("456d");var o=i("bd86"),s=i("2f62");function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,o)}return i}var r={name:"goods-card",props:["goodsinfo","index"],computed:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(i,!0).forEach(function(e){Object(o.a)(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({},Object(s.e)("d2admin/user",["info"])),methods:{update:function(){this.$emit("update",this.goodsinfo)},del:function(){this.$emit("delete",this.goodsinfo,this.index)}}},l=(i("6dc8"),i("2877")),n=function(e){e.options.__source="src/views/demo/components/goodsCard.vue"},c=Object(l.a)(r,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("img",{staticClass:"image",attrs:{src:e.goodsinfo.img}}),i("div",{staticClass:"wrapper"},[i("div",{staticClass:"goodsname"},[e._v(e._s(e.goodsinfo.name))]),i("div",{staticClass:"goodsdsc"},[e._v(e._s(e.goodsinfo.des))]),i("div",{staticClass:"goodsconnect"},[e._v("联系电话:"+e._s(e.goodsinfo.mobile))]),i("div",{staticClass:"goodsconnect"},[e._v("联系邮箱:"+e._s(e.goodsinfo.email))]),i("div",{staticClass:"goodsconnect"},[e._v("发布日期:"+e._s(e.dayjs(e.goodsinfo.createtime).format("YYYY-MM-DD HH:mm:ss")))]),i("div",{staticClass:"goodsprice"},[e._v("¥"+e._s(e.goodsinfo.price))]),e.info.username?i("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.update}},[e._v("编辑")]):e._e(),e.info.username?i("el-button",{attrs:{type:"goodsinfo",size:"mini"},on:{click:e.del}},[e._v("删除")]):e._e()],1)])},[],!1,null,"3c14ede4",null);"function"==typeof n&&n(c);t.default=c.exports},a9a1:function(e,t,i){"use strict";var o=i("3bd3");i.n(o).a},e941:function(e,t,i){}}]);